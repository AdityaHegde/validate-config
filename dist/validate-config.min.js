!function(a,b){"function"==typeof define&&define.amd?define([],function(){return a.validate_config=b()}):"object"==typeof exports?module.exports=b():a.ValidateConfig=b()}(this,function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;return a=function(){function a(){for(var a in b)this[b[a]]={}}var b={type:"invalidType",value:"invalidValue",extra:"extraKey",mandatory:"mandatoryKeyMissing"};return a.prototype.markAs=function(a,c,d,e){if(b[a]){var f=b[a];this[f][c]={type:d,details:e}}},a.prototype.unmarkAs=function(a,c){if(b[a]){var d=b[a];delete this[d][c]}},a}(),function(a,b){define("deep_keys_lib",[],function(){return a.deep_keys_lib=b()})}(this,function(){var a,b,c,d,e,f,g,h,i,j,k,l,m;return a=function(a){return{}.toString.call(a).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},b=function(a){return null!==a&&void 0!==a},i=l=function(){var c=function(a){return a.match(/^\d+$/)?[]:{}},d=function(e,f,g,h){var i=f.split(/\./),j=0;for(j=0;j<i.length-1;j++){if("*"===i[j]){var k=[];if("array"===a(e)||"object"===a(e)){var l=e;"object"===a(e)&&h&&h.length>0&&(l=h[0],h=h.splice(1));for(var m in l)if(null!==e[m]&&void 0!==e[m]){var n=d(e[m],i.slice(j+1).join("."),g,h);n&&Array.prototype.push.apply(k,n)}}return k.length>0?k:null}if(b(e[i[j]]))e=e[i[j]];else{if(!g)return null;e[i[j]]=c(i[j+1]),e=e[i[j]]}}return""!==i[j]?("array"===a(e)&&i[j].match(/^\d*$/)||"object"===a(e))&&"*"!==i[j]?[[e,i[j],e[i[j]]]]:null:[[e,i[j],e]]};return d}(),c=function(){return function(a,b,c,d,e){var f=l(a,b,!0,e);if(f)for(var g=0;g<f.length;g++)d&&null!==f[g][0][f[g][1]]&&void 0!==f[g][0][f[g][1]]||(f[g][0][f[g][1]]=c)}}(),d=function(){return function(a,b,c){var d=l(a,b,!1,c);if(d)for(var e=0;e<d.length;e++)delete d[e][0][d[e][1]]}}(),e=m=function(){function a(){this.hierarchy=[],this.hierarchyPlaceholder=[],this.hierarchyPlaceholders=[],this.hierarchyStr="",this.hierarchyPlaceholderStr="",this.fullHierarchyStr="",this.fullHierarchyPlaceholderStr=""}return a.prototype.replacePlaceholders=function(a){for(var b=a.slice(),c=0,d=0;c<this.hierarchy.length&&c<b.length&&d<this.hierarchyPlaceholders.length;c++)if(c===this.hierarchyPlaceholders[d].index){if(b[c]!==this.hierarchyPlaceholders[d].placeholder)break;b[c]=this.hierarchy[c],d++}else if(this.hierarchy[c]!==b[c])break;return b},a.prototype.pushToHierarchy=function(a,b){b=b||a,this.hierarchyStr=this.hierarchy.join("."),this.hierarchyPlaceholderStr=this.hierarchyPlaceholder.join("."),a!==b&&this.hierarchyPlaceholders.push({placeholder:b,index:this.hierarchyPlaceholder.length}),this.hierarchy.push(a),this.hierarchyPlaceholder.push(b),this.fullHierarchyStr=this.hierarchy.join("."),this.fullHierarchyPlaceholderStr=this.hierarchyPlaceholder.join(".")},a.prototype.popFromHierarchy=function(){this.hierarchyPlaceholders.length>0&&this.hierarchyPlaceholders[this.hierarchyPlaceholders.length-1].index===this.hierarchyPlaceholder.length-1&&this.hierarchyPlaceholders.pop(),this.hierarchy.pop(),this.hierarchyPlaceholder.pop(),this.hierarchyStr=this.hierarchy.slice(0,-1).join("."),this.hierarchyPlaceholderStr=this.hierarchyPlaceholder.slice(0,-1).join("."),this.fullHierarchyStr=this.hierarchy.join("."),this.fullHierarchyPlaceholderStr=this.hierarchyPlaceholder.join(".")},a}(),f=function(){var b=function(c,d,e){var f,g=0;if("object"===a(c)){if("object"===a(d)){f={};for(var h in d){e.hierarchy.pushToHierarchy(h);var i=void 0;e.ignoreKeys[e.hierarchy.fullHierarchyStr]||(i=b(c[h],d[h],e)),e.hierarchy.popFromHierarchy(),void 0!==i&&(f[h]=i,g=1)}}}else if("array"===a(c)){if("array"===a(d)){f=[];for(var j=0;j<d.length;j++){e.hierarchy.pushToHierarchy(j,"*");var i=void 0;e.ignoreKeys[e.hierarchy.fullHierarchyStr]||(i=b(c[j],d[j],e)),e.hierarchy.popFromHierarchy(),f.push(i),void 0!==i&&(g=1)}}}else e.ignoreKeys[e.hierarchy.fullHierarchyStr]||c!==d&&(f=d,g=1);return 1===g?f:void 0};return function(a,c,d){return b(a,c,{ignoreKeys:d,hierarchy:new m})}}(),j=function(){return function(a,c,d,e){d=!!d;var f=l(a,c,!1,e),g=!d;if(f)for(var h=0;h<f.length;h++){var i=b(f[h][2]);g=d&&(g||i)||!d&&g&&i}else g=!1;return g}}(),g=function(){return function(a,b,c){var d=l(a,b,!1,c),e=[];if(d)for(var f=0;f<d.length;f++)e.push(d[f][2]);return e.length>0?e:null}}(),k=function(){var c=function(d,e){if("object"===a(d)||"array"===a(d))for(var f in d)d[f]=c(d[f],e);else for(var h=d.match(/<.*?>/g)||[],i=0;i<h.length;i++){var j=g(e,h[i].replace(/<(.*)>/,"$1")),k=new RegExp(h[i].replace(/\./,"\\."));j&&b(j[0])&&(d=d.replace(k,j[0]))}return d};return c}(),h=y=function(e,h,i){var j={typeOf:a,notNone:b,deepSearch:l,assignValue:c,deleteKey:d,diff:f,exists:e,getValue:g,replaceKeys:h,HierarchyManager:i};return j}(j,k,e)}),b=x=function(a){return{}.toString.call(a).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},c=function(){return{arrayValidator:function(a,b,c){for(var d=0;d<b.length;d++){this.hierarchy.pushToHierarchy(d,c.placeholderKey);var e=this.morphKey(d,b[d],c.elementsValidator,!0);this.validator(d,e,c.elementsValidator),b[d]=e,this.hierarchy.popFromHierarchy()}return!0}}}(),d=function(){return{numberValidator:function(a,b,c){return c.min&&b<c.min||c.max&&b>c.max?(this.invalidKeys.markAs("value",this.hierarchy.fullHierarchyStr,"error",{key:a,actualValue:b,validator:c,hierarchyStr:this.hierarchy.hierarchyStr}),!1):!0}}}(),e=function(){return{regexValidator:function(a,b,c){var d=!0;return c.regex&&(d=!!b.match(c.regex)),d||this.invalidKeys.markAs("value",this.hierarchy.fullHierarchyStr,"error",{key:a,actualValue:b,validator:c,hierarchyStr:this.hierarchy.hierarchyStr}),d}}}(),f=function(){return typeToValidatorMap={object:"objectValidator",array:"arrayValidator",string:"regexValidator",number:"numberValidator",__default__:"regexValidator"},{validator:function(a,b,c){if(this.fullKeysPresent[this.hierarchy.fullHierarchy]=1,this.typeValidator(a,b,c)){var d=typeToValidatorMap[c.type]||typeToValidatorMap.__default__;this[d](a,b,c)}return!0}}}(),g=function(){var a={},b=function(c,d,e,f,g){var h,i=c+"__"+d+"__"+e+"__"+f;if(a[i])h=a[i].val;else{if(0===d)h=f;else if(0===f)h=d;else{var j=c.charAt(d-1)===e.charAt(f-1)?0:1;h=Math.min(b(c,d-1,e,f,g)+1,b(c,d,e,f-1,g)+1,b(c,d-1,e,f-1,g)+j)}a[i]={val:h}}return h},c=function(a,c){var d;return a>c&&(d=a,a=c,c=d),b(a,a.length,c,c.length)};return c}(),h=function(a){return{extraParamsValidator:function(b,c,d){var e=[],f=[],g=[];for(var h in d.keys){var i=(h.length,b.length),j=a(h,b);.25*i>=j&&f.push({ld:j,ck:h})}if(e=f.sort(function(a,b){return a.ld-b.ld}).map(function(a){return a.ck}),this.fullKeysSet[b])for(var k=0;k<this.fullKeysSet[b].length;k++){var l=this.hierarchy.replacePlaceholders(this.fullKeysSet[b][k]).join(".");this.fullKeysPresent[l]||g.push(l)}return this.invalidKeys.markAs("extra",this.hierarchy.fullHierarchyStr,"warn",{key:b,val:c,validator:d,hierarchyStr:this.hierarchy.hierarchyStr,matches:e,otherLoc:g}),!0}}}(g),i=function(){return{mandatoryParamsValidator:function(a,b,c){return this.invalidKeys.markAs("mandatory",this.hierarchy.fullHierarchyStr,"error",{key:a,validator:c,hierarchyStr:this.hierarchy.hierarchyStr}),!0}}}(),j=function(){return{objectValidator:function(a,b,c){for(var d in c.keys){var e=b[d],f=b.hasOwnProperty(d);this.hierarchy.pushToHierarchy(d,d),e=this.morphKey(d,e,c.keys[d],f),f||null!==e&&void 0!==e?(b[d]=e,this.validator(d,b[d],c.keys[d])):c.keys[d].isMandatory&&this.mandatoryParamsValidator(d,null,c.keys[d]),this.hierarchy.popFromHierarchy()}for(var g in b)c.keys[g]||(this.hierarchy.pushToHierarchy(g,g),this.extraParamsValidator(g,b[g],c),this.hierarchy.popFromHierarchy());return!0}}}(),k=function(){return{typeValidator:function(a,b,c){return x(b)!==c.type?(this.invalidKeys.markAs("type",this.hierarchy.fullHierarchyStr,"error",{key:a,actualType:x(b),validator:c,hierarchyStr:this.hierarchy.hierarchyStr}),!1):!0}}}(),l=function(){for(var a={},b=0;b<arguments.length;b++)for(var c in arguments[b])a[c]=arguments[b][c];return a}(),m={morphKey:function(a,b,c,d){var e=b;return d?(c.morph&&(e=this.morphType(a,e,c,d)),e=this.morphValue(a,e,c,d)):c.morph&&c.morph.hasOwnProperty("default")&&(e=c.morph["default"]),e}},n={string:function(a,b,c){var d=b;switch(c.morph.type){case"parse":default:d=Number(b),isNaN(d)&&(d=b)}return d},"boolean":function(a,b){return b?1:0},__default__:function(a,b){return b}},o=function(){return{number:function(a,b){return b+""},"boolean":function(a,b){return b+""},array:function(a,b,c){var d=b;switch(c.morph.type){case"join":d=b.join(c.morph.joinStr||",");break;case"stringify":default:d=JSON.stringify(b)}return d},object:function(a,b,c){var d=b;switch(c.morph.type){default:case"stringify":d=JSON.stringify(b)}return d},__default__:function(a,b){return b}}}(),p={string:function(a,b,c){var d=b;switch(c.morph.type){case"parse":default:try{d=JSON.parse(b)}catch(e){this.logger.error("InvalidValue",{key:a,actualValue:b,validator:c,hierarchyStr:this.hierarchy.hierarchyStr})}}return d},array:function(a,b,c){var d=b;switch(c.morph.type){case"indexToKeys":default:var e=0;for(d={};e<b.length;e++)c.morph.indexToKeys.length>e&&(d[c.morph.indexToKeys[e].key]=b[e]);for(;e<c.morph.indexToKeys.length;e++)c.morph.indexToKeys[e]["default"]&&(d[c.morph.indexToKeys[e].key]=c.morph.indexToKeys[e]["default"])}return d},__default__:function(a,b){return b}},q={string:function(a,b,c){var d=b;switch(c.morph.type){case"split":var e=new RegExp(c.morph.splitStr||",");d=b.split(e);break;case"parse":default:try{d=JSON.parse(b)}catch(f){this.logger.error("InvalidValue",{key:a,actualValue:b,validator:c,hierarchyStr:this.hierarchy.hierarchyStr})}}return d},array:function(a,b){return b},__default__:function(a,b){return null!==b||void 0!==b?[b]:b}},r=function(a,b,c,d){var e={number:a,string:b,object:c,array:d,__default__:{__default__:function(){return null}}};return{morphType:function(a,b,c){var d=e[c.type]||e.__default__,f=d[x(b)]||d.__default__;return f.call(this,a,b,c)}}}(n,o,p,q),s=function(){return{seperateKeys:function(a,b){return b},mergeKeys:function(a,b,c){if(c.morph.mergeKeys)for(var d in c.morph.mergeKeys)null!==b[d]&&void 0!==b[d]&&(y.assignValue(b,c.morph.mergeKeys[d].toKey,b[d],c.morph.dontReplaceExisting,c.morph.mergeKeys[d].expandKeys),delete b[d]);return b},__default__:function(a,b){return b}}}(),t=function(a){var b={object:a};return{morphValue:function(a,c,d){if(d.morph){var e=b[d.type],f=e&&(e[d.morph.valueMorphType]||e.__default__);if(f)return f.call(this,a,c,d)}return c}}}(s),u=function(){for(var a={},b=0;b<arguments.length;b++)for(var c in arguments[b])a[c]=arguments[b][c];return a}(),v=function(){return{_prepareValidator:function(a){if("object"===a.type)for(var b in a.keys)this.hierarchy.pushToHierarchy(b),this._prepareValidator(a.keys[b]),a.keys[b].parentValidator=a,this.fullKeysSet[b]||(this.fullKeysSet[b]=[]),this.fullKeysSet[b].push(this.hierarchy.hierarchyPlaceholder.slice()),this.hierarchy.popFromHierarchy();else"array"===a.type&&(this.hierarchy.pushToHierarchy("arrayElement","*"),a.placeholderKey="*",a.elementsValidator.parentValidator=a,this._prepareValidator(a.elementsValidator),this.hierarchy.popFromHierarchy());a.morph&&"boolean"===x(a.morph)&&(a.morph={})},setValidator:function(a){this.reset(),this.hierarchy.pushToHierarchy("$"),this._prepareValidator(a),this.hierarchy.popFromHierarchy(),this.validatorConfig=a}}}(),w=function(a){function b(a){a?this.setValidator(a):this.reset()}b.prototype.reset=function(){this.hierarchy=new y.HierarchyManager,this.invalidKeys=new a,this.fullKeysPresent={},this.fullKeysSet={}},b.prototype.validate=function(a){this.hierarchy.pushToHierarchy("$","$"),this.validator("$",a,this.validatorConfig),this.hierarchy.popFromHierarchy()};for(var c=2;c<arguments.length;c++)for(var d in arguments[c])b.prototype[d]=arguments[c][d];return b}(a)});