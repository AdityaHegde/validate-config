!function(a,b){"function"==typeof define&&define.amd?define(["deep_keys_lib"],function(c){return a.validate_config=b(c)}):"object"==typeof exports?module.exports=b(require("deep-keys-lib")):a.ValidateConfig=b(DeepKeysLib)}(this,function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;return a=function(){function a(){for(var a in b)this[b[a]]={}}var b={type:"invalidType",value:"invalidValue",extra:"extraKey",mandatory:"mandatoryKeyMissing"};return a.prototype.markAs=function(a,c,d,e){if(b[a]){var f=b[a];this[f][c]={type:d,details:e}}},a.prototype.unmarkAs=function(a,c){if(b[a]){var d=b[a];delete this[d][c]}},a}(),b=function(a){return{}.toString.call(a).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},c=function(a,b,c){for(var d=0;d<b.length;d++){this.hierarchy.pushToHierarchy(d,c.placeholderKey);var e=this.morphKey(d,b[d],c.elementsValidator,!0);this.validator(d,e,c.elementsValidator),b[d]=e,this.hierarchy.popFromHierarchy()}return!0},d=function(a,b,c){return c.min&&b<c.min||c.max&&b>c.max?(this.invalidKeys.markAs("value",this.hierarchy.fullHierarchyStr,"error",{key:a,actualValue:b,validator:c,hierarchyStr:this.hierarchy.hierarchyStr}),!1):!0},e=function(a,b,c){var d=!0;return c.regex&&(d=!!b.match(c.regex)),d||this.invalidKeys.markAs("value",this.hierarchy.fullHierarchyStr,"error",{key:a,actualValue:b,validator:c,hierarchyStr:this.hierarchy.hierarchyStr}),d},f=function(){return typeToValidatorMap={object:"objectValidator",array:"arrayValidator",string:"regexValidator",number:"numberValidator",__default__:"regexValidator"},function(a,b,c){if(this.fullKeysPresent[this.hierarchy.fullHierarchy]=1,this.typeValidator(a,b,c)){var d=typeToValidatorMap[c.type]||typeToValidatorMap.__default__;this[d](a,b,c)}return!0}}(b),g=function(){var a={},b=function(c,d,e,f,g){var h,i=c+"__"+d+"__"+e+"__"+f;if(a[i])h=a[i].val;else{if(0===d)h=f;else if(0===f)h=d;else{var j=c.charAt(d-1)===e.charAt(f-1)?0:1;h=Math.min(b(c,d-1,e,f,g)+1,b(c,d,e,f-1,g)+1,b(c,d-1,e,f-1,g)+j)}a[i]={val:h}}return h},c=function(a,c){var d;return a>c&&(d=a,a=c,c=d),b(a,a.length,c,c.length)};return c}(),h=function(a,b){return function(a,c,d){var e=[],f=[],g=[];for(var h in d.keys){var i=(h.length,a.length),j=b(h,a);.25*i>=j&&f.push({ld:j,ck:h})}if(e=f.sort(function(a,b){return a.ld-b.ld}).map(function(a){return a.ck}),this.fullKeysSet[a])for(var k=0;k<this.fullKeysSet[a].length;k++){var l=this.hierarchy.replacePlaceholders(this.fullKeysSet[a][k]).join(".");this.fullKeysPresent[l]||g.push(l)}return this.invalidKeys.markAs("extra",this.hierarchy.fullHierarchyStr,"warn",{key:a,val:c,validator:d,hierarchyStr:this.hierarchy.hierarchyStr,matches:e,otherLoc:g}),!0}}(b,g),i=function(a,b,c){return this.invalidKeys.markAs("mandatory",this.hierarchy.fullHierarchyStr,"error",{key:a,validator:c,hierarchyStr:this.hierarchy.hierarchyStr}),!0},j=function(a,b,c){for(var d in c.keys){var e=b[d],f=b.hasOwnProperty(d);this.hierarchy.pushToHierarchy(d,d),e=this.morphKey(d,e,c.keys[d],f),f||null!==e&&void 0!==e?(b[d]=e,this.validator(d,b[d],c.keys[d])):c.keys[d].isMandatory&&this.mandatoryParamsValidator(d,null,c.keys[d]),this.hierarchy.popFromHierarchy()}for(var g in b)c.keys[g]||(this.hierarchy.pushToHierarchy(g,g),this.extraParamsValidator(g,b[g],c),this.hierarchy.popFromHierarchy());return!0},k=function(a,c,d){return b(c)!==d.type?(this.invalidKeys.markAs("type",this.hierarchy.fullHierarchyStr,"error",{key:a,actualType:b(c),validator:d,hierarchyStr:this.hierarchy.hierarchyStr}),!1):!0},l=function(a,b,c,d,e,f,g,h){return{arrayValidator:a,numberValidator:b,regexValidator:c,validator:d,extraParamsValidator:e,mandatoryParamsValidator:f,objectValidator:g,typeValidator:h}}(c,d,e,f,h,i,j,k),m={morphKey:function(a,b,c,d){var e=b;return d?(c.morph&&(e=this.morphType(a,e,c,d)),e=this.morphValue(a,e,c,d)):c.morph&&c.morph.hasOwnProperty("default")&&(e=c.morph["default"]),e}},n={string:function(a,b,c){var d=b;switch(c.morph.type){case"parse":default:d=Number(b),isNaN(d)&&(d=b)}return d},"boolean":function(a,b){return b?1:0},__default__:function(a,b){return b}},o={number:function(a,b){return b+""},"boolean":function(a,b){return b+""},array:function(a,b,c){var d=b;switch(c.morph.type){case"join":d=b.join(c.morph.joinStr||",");break;case"stringify":default:d=JSON.stringify(b)}return d},object:function(a,b,c){var d=b;switch(c.morph.type){default:case"stringify":d=JSON.stringify(b)}return d},__default__:function(a,b){return b}},p={string:function(a,b,c){var d=b;switch(c.morph.type){case"parse":default:try{d=JSON.parse(b)}catch(e){this.logger.error("InvalidValue",{key:a,actualValue:b,validator:c,hierarchyStr:this.hierarchy.hierarchyStr})}}return d},array:function(a,b,c){var d=b;switch(c.morph.type){case"indexToKeys":default:var e=0;for(d={};e<b.length;e++)c.morph.indexToKeys.length>e&&(d[c.morph.indexToKeys[e].key]=b[e]);for(;e<c.morph.indexToKeys.length;e++)c.morph.indexToKeys[e]["default"]&&(d[c.morph.indexToKeys[e].key]=c.morph.indexToKeys[e]["default"])}return d},__default__:function(a,b){return b}},q={string:function(a,b,c){var d=b;switch(c.morph.type){case"split":var e=new RegExp(c.morph.splitStr||",");d=b.split(e);break;case"parse":default:try{d=JSON.parse(b)}catch(f){this.logger.error("InvalidValue",{key:a,actualValue:b,validator:c,hierarchyStr:this.hierarchy.hierarchyStr})}}return d},array:function(a,b){return b},__default__:function(a,b){return null!==b||void 0!==b?[b]:b}},r=function(a,b,c,d,e){var f={number:b,string:c,object:d,array:e,__default__:{__default__:function(){return null}}};return{morphType:function(b,c,d){var e=f[d.type]||f.__default__,g=e[a(c)]||e.__default__;return g.call(this,b,c,d)}}}(b,n,o,p,q),s=function(a){return{seperateKeys:function(a,b){return b},mergeKeys:function(b,c,d){if(d.morph.mergeKeys)for(var e in d.morph.mergeKeys)null!==c[e]&&void 0!==c[e]&&(a.assignValue(c,d.morph.mergeKeys[e].toKey,c[e],d.morph.dontReplaceExisting,d.morph.mergeKeys[e].expandKeys),delete c[e]);return c},__default__:function(a,b){return b}}}(deep_keys_lib),t=function(a,b){var c={object:b};return{morphValue:function(a,b,d){if(d.morph){var e=c[d.type],f=e&&(e[d.morph.valueMorphType]||e.__default__);if(f)return f.call(this,a,b,d)}return b}}}(b,s),u=function(a,b,c){for(var d=[a,b,c],e={},f=0;f<d.length;f++)for(var g in d[f])e[g]=d[f][g];return e}(m,r,t),v={_prepareValidator:function(a){if("object"===a.type)for(var c in a.keys)this.hierarchy.pushToHierarchy(c),this._prepareValidator(a.keys[c]),a.keys[c].parentValidator=a,this.fullKeysSet[c]||(this.fullKeysSet[c]=[]),this.fullKeysSet[c].push(this.hierarchy.hierarchyPlaceholder.slice()),this.hierarchy.popFromHierarchy();else"array"===a.type&&(this.hierarchy.pushToHierarchy("arrayElement","*"),a.placeholderKey="*",a.elementsValidator.parentValidator=a,this._prepareValidator(a.elementsValidator),this.hierarchy.popFromHierarchy());a.morph&&"boolean"===b(a.morph)&&(a.morph={})},setValidator:function(a){this.reset(),this.hierarchy.pushToHierarchy("$"),this._prepareValidator(a),this.hierarchy.popFromHierarchy(),this.validatorConfig=a}},w=function(a,b,c,d,e){function f(a){a?this.setValidator(a):this.reset()}f.prototype.reset=function(){this.hierarchy=new b.HierarchyManager,this.invalidKeys=new a,this.fullKeysPresent={},this.fullKeysSet={}},f.prototype.validate=function(a){this.hierarchy.pushToHierarchy("$","$"),this.validator("$",a,this.validatorConfig),this.hierarchy.popFromHierarchy()};for(var g=[c,d,e],h=0;h<g.length;h++)for(var i in g[h])f.prototype[i]=g[h][i];return f}(a,deep_keys_lib,l,u,v)});